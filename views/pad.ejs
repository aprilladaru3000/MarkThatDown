<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarkThatDown - Realtime Markdown Editor</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <!-- MathJax for mathematical expressions -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
</head>

<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-edit"></i>
                    <h1>MarkThatDown</h1>
                </div>
                
                <!-- Authentication Section -->
                <div class="auth-section" id="auth-section">
                    <button id="login-btn" class="btn btn-outline">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                    <button id="register-btn" class="btn btn-primary">
                        <i class="fas fa-user-plus"></i> Register
                    </button>
                </div>
                
                <div class="user-section" id="user-section" style="display: none;">
                    <span id="username-display"></span>
                    <button id="logout-btn" class="btn btn-outline">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
                
                <div class="header-actions">
                    <button id="theme-toggle-btn" class="btn btn-secondary">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button id="fullscreen-btn" class="btn btn-secondary">
                        <i class="fas fa-expand"></i>
                    </button>
                    <button id="download-btn" class="btn btn-primary">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <div class="editor-container">
                <!-- Editor Panel -->
                <div class="panel editor-panel">
                    <div class="panel-header">
                        <h3><i class="fas fa-edit"></i> Editor</h3>
                        <div class="panel-actions">
                            <button id="search-btn" class="btn btn-sm btn-outline" title="Search & Replace">
                                <i class="fas fa-search"></i>
                            </button>
                            <button id="template-btn" class="btn btn-sm btn-outline" title="Templates">
                                <i class="fas fa-file-alt"></i>
                            </button>
                            <button id="history-btn" class="btn btn-sm btn-outline" title="Document History">
                                <i class="fas fa-history"></i>
                            </button>
                            <button id="clear-btn" class="btn btn-sm btn-outline">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Toolbar -->
                    <div class="editor-toolbar">
                        <button class="toolbar-btn" data-insert="**bold**" title="Bold">
                            <i class="fas fa-bold"></i>
                        </button>
                        <button class="toolbar-btn" data-insert="*italic*" title="Italic">
                            <i class="fas fa-italic"></i>
                        </button>
                        <button class="toolbar-btn" data-insert="~~strikethrough~~" title="Strikethrough">
                            <i class="fas fa-strikethrough"></i>
                        </button>
                        <div class="toolbar-separator"></div>
                        <button class="toolbar-btn" data-insert="# " title="Heading 1">
                            <i class="fas fa-heading"></i>1
                        </button>
                        <button class="toolbar-btn" data-insert="## " title="Heading 2">
                            <i class="fas fa-heading"></i>2
                        </button>
                        <button class="toolbar-btn" data-insert="### " title="Heading 3">
                            <i class="fas fa-heading"></i>3
                        </button>
                        <div class="toolbar-separator"></div>
                        <button class="toolbar-btn" data-insert="- " title="Unordered List">
                            <i class="fas fa-list-ul"></i>
                        </button>
                        <button class="toolbar-btn" data-insert="1. " title="Ordered List">
                            <i class="fas fa-list-ol"></i>
                        </button>
                        <button class="toolbar-btn" data-insert="> " title="Blockquote">
                            <i class="fas fa-quote-left"></i>
                        </button>
                        <div class="toolbar-separator"></div>
                        <button class="toolbar-btn" data-insert="[link](url)" title="Link">
                            <i class="fas fa-link"></i>
                        </button>
                        <button class="toolbar-btn" data-insert="![alt](image-url)" title="Image">
                            <i class="fas fa-image"></i>
                        </button>
                        <button class="toolbar-btn" data-insert="`code`" title="Inline Code">
                            <i class="fas fa-code"></i>
                        </button>
                        <button class="toolbar-btn" data-insert="```\ncode block\n```" title="Code Block">
                            <i class="fas fa-file-code"></i>
                        </button>
                        <div class="toolbar-separator"></div>
                        <button class="toolbar-btn" data-insert="| Column 1 | Column 2 |\n|----------|----------|\n| Data 1   | Data 2   |" title="Table">
                            <i class="fas fa-table"></i>
                        </button>
                        <button class="toolbar-btn" data-insert="---" title="Horizontal Rule">
                            <i class="fas fa-minus"></i>
                        </button>
                        <button class="toolbar-btn" data-insert="$$math$$" title="Math Expression">
                            <i class="fas fa-square-root-alt"></i>
                        </button>
                        <div class="toolbar-separator"></div>
                        <button id="media-upload-btn" class="toolbar-btn" title="Upload Media">
                            <i class="fas fa-upload"></i>
                        </button>
                        <button id="media-gallery-btn" class="toolbar-btn" title="Media Gallery">
                            <i class="fas fa-images"></i>
                        </button>
                    </div>
                    
                    <div class="panel-body">
                        <textarea id="pad" placeholder="Write your markdown here...&#10;&#10;# Welcome to MarkThatDown!&#10;&#10;This is a **real-time** collaborative markdown editor.&#10;&#10;## Features:&#10;- Real-time collaboration&#10;- Live preview&#10;- Modern UI&#10;- Export functionality&#10;- Document history&#10;- Comments & annotations&#10;- Math expressions&#10;- Diagrams & charts&#10;&#10;Start typing to see the magic happen!"></textarea>
                    </div>
                </div>

                <!-- Preview Panel -->
                <div class="panel preview-panel">
                    <div class="panel-header">
                        <h3><i class="fas fa-eye"></i> Preview</h3>
                        <div class="panel-actions">
                            <button id="comments-btn" class="btn btn-sm btn-outline" title="Comments">
                                <i class="fas fa-comments"></i>
                            </button>
                            <button id="toggle-preview-btn" class="btn btn-sm btn-outline">
                                <i class="fas fa-eye-slash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div id="markdown" class="markdown-content"></div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Status Bar -->
        <footer class="status-bar">
            <div class="status-content">
                <div class="status-item">
                    <i class="fas fa-users"></i>
                    <span id="user-count">1</span> users online
                </div>
                <div class="status-item">
                    <i class="fas fa-clock"></i>
                    <span id="last-saved">Just now</span>
                </div>
                <div class="status-item">
                    <i class="fas fa-link"></i>
                    <span id="document-id">home</span>
                </div>
                <div class="status-item">
                    <i class="fas fa-code-branch"></i>
                    <span id="version-info">v1</span>
                </div>
            </div>
        </footer>
    </div>

    <!-- Modals -->
    
    <!-- Login Modal -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-sign-in-alt"></i> Login</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="login-form">
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input type="password" id="login-password" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Login</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="register-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-plus"></i> Register</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="register-form">
                    <div class="form-group">
                        <label for="register-username">Username</label>
                        <input type="text" id="register-username" required>
                    </div>
                    <div class="form-group">
                        <label for="register-email">Email</label>
                        <input type="email" id="register-email" required>
                    </div>
                    <div class="form-group">
                        <label for="register-password">Password</label>
                        <input type="password" id="register-password" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Register</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Search Modal -->
    <div id="search-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-search"></i> Search & Replace</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="search-input">Find</label>
                    <input type="text" id="search-input" placeholder="Search text...">
                </div>
                <div class="form-group">
                    <label for="replace-input">Replace with</label>
                    <input type="text" id="replace-input" placeholder="Replace text...">
                </div>
                <div class="search-options">
                    <label>
                        <input type="checkbox" id="case-sensitive"> Case sensitive
                    </label>
                    <label>
                        <input type="checkbox" id="whole-word"> Whole word
                    </label>
                </div>
                <div class="search-actions">
                    <button id="find-btn" class="btn btn-secondary">Find</button>
                    <button id="replace-btn" class="btn btn-primary">Replace</button>
                    <button id="replace-all-btn" class="btn btn-primary">Replace All</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Template Modal -->
    <div id="template-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-file-alt"></i> Document Templates</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="template-grid">
                    <div class="template-item" data-template="blank">
                        <h4>Blank Document</h4>
                        <p>Start with a clean slate</p>
                    </div>
                    <div class="template-item" data-template="meeting-notes">
                        <h4>Meeting Notes</h4>
                        <p>Template for meeting documentation</p>
                    </div>
                    <div class="template-item" data-template="project-plan">
                        <h4>Project Plan</h4>
                        <p>Template for project planning</p>
                    </div>
                    <div class="template-item" data-template="blog-post">
                        <h4>Blog Post</h4>
                        <p>Template for blog writing</p>
                    </div>
                    <div class="template-item" data-template="technical-doc">
                        <h4>Technical Documentation</h4>
                        <p>Template for technical writing</p>
                    </div>
                    <div class="template-item" data-template="research-paper">
                        <h4>Research Paper</h4>
                        <p>Template for academic writing</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- History Modal -->
    <div id="history-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-history"></i> Document History</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="history-list" class="history-list">
                    <!-- History items will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Comments Panel -->
    <div id="comments-panel" class="comments-panel">
        <div class="comments-header">
            <h3><i class="fas fa-comments"></i> Comments</h3>
            <button class="comments-close">&times;</button>
        </div>
        <div class="comments-body">
            <div id="comments-list" class="comments-list">
                <!-- Comments will be populated here -->
            </div>
            <div class="comment-input">
                <textarea id="new-comment" placeholder="Add a comment..."></textarea>
                <button id="add-comment-btn" class="btn btn-primary">Add Comment</button>
            </div>
        </div>
    </div>

    <!-- Media Gallery Panel -->
    <div id="media-gallery-panel" class="media-gallery-panel">
        <div class="media-gallery-header">
            <h3><i class="fas fa-images"></i> Media Gallery</h3>
            <button class="media-gallery-close">&times;</button>
        </div>
        <div class="media-gallery-body">
            <div class="media-upload-area" id="media-upload-area">
                <div class="upload-zone" id="upload-zone">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>Drag & drop files here or click to upload</p>
                    <input type="file" id="media-file-input" multiple accept="image/*,video/*,audio/*,application/pdf,text/plain,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/zip,application/x-rar-compressed,application/x-7z-compressed" style="display: none;">
                    <button class="btn btn-primary" onclick="document.getElementById('media-file-input').click()">
                        <i class="fas fa-upload"></i> Choose Files
                    </button>
                </div>
            </div>
            <div id="media-gallery-grid" class="media-gallery-grid">
                <!-- Media items will be populated here -->
            </div>
        </div>
    </div>

    <!-- Media Upload Modal -->
    <div id="media-upload-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-upload"></i> Upload Media</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="upload-progress" id="upload-progress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <p id="upload-status">Uploading...</p>
                </div>
                <div class="upload-preview" id="upload-preview">
                    <!-- File previews will be shown here -->
                </div>
                <div class="upload-actions">
                    <button id="upload-files-btn" class="btn btn-primary" disabled>
                        <i class="fas fa-upload"></i> Upload Files
                    </button>
                    <button id="cancel-upload-btn" class="btn btn-outline">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.rawgit.com/showdownjs/showdown/1.0.2/dist/showdown.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="script.js"></script>
</body>
</html> 